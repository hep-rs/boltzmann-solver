<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Solver for the number density evolution given by integrating the Boltzmann equation."><meta name="keywords" content="rust, rustlang, rust-lang, solver"><title>boltzmann_solver::solver - Rust</title><link rel="stylesheet" type="text/css" href="../../normalize.css"><link rel="stylesheet" type="text/css" href="../../rustdoc.css" id="mainThemeStyle"><link rel="stylesheet" type="text/css" href="../../light.css"  id="themeStyle"><link rel="stylesheet" type="text/css" href="../../dark.css" disabled ><link rel="stylesheet" type="text/css" href="../../ayu.css" disabled ><script id="default-settings" ></script><script src="../../storage.js"></script><script src="../../crates.js"></script><noscript><link rel="stylesheet" href="../../noscript.css"></noscript><link rel="alternate icon" type="image/png" href="../../favicon-16x16.png"><link rel="alternate icon" type="image/png" href="../../favicon-32x32.png"><link rel="icon" type="image/svg+xml" href="../../favicon.svg"><link
  rel="stylesheet"
  href="https://cdn.jsdelivr.net/npm/katex@0.11/dist/katex.min.css"
  crossorigin="anonymous"
/>
<script
  src="https://cdn.jsdelivr.net/npm/katex@0.11/dist/katex.min.js"
  crossorigin="anonymous"
></script>
<script>
  "use strict";
  const macros = {
    "\\vt": "\\boldsymbol{#1}",
    "\\pfrac": "\\frac{\\partial{#1}}{\\partial{#2}}",
    "\\dd": "\\mathop{}\\!\\mathrm{d}",
    "\\ddfrac": "\\frac{\dd{#1}}{\dd{#2}}",
    "\\defeq": "\\vcentcolon=",
    "\\abs": "\\left\\lvert{#1}\\right\\rvert",
    "\\CP": "\\mathcal{CP}",
    "\\scM": "\\mathcal{M}",
  };

  // Display math is inputted in the documentation as:
  //
  // ```math
  //   \int_0^1 x
  // ```
  //
  // and in the HTML appears as
  //
  // ```html
  // <pre><code class="language-math">...</code></pre>
  // ```
  document.addEventListener("DOMContentLoaded", function () {
    // console.log("Replacing display maths");
    const maths = document.getElementsByClassName("language-math");
    for (let i = 0; i < maths.length; i++) {
      const el = maths[i];
      el.parentNode.replaceWith(el);
      katex.render(el.innerText, el, { displayMode: true, macros: macros });
    }
  });

  // Inline math is inputted in the documentation as `$...$` (with the
  // backticks) and in the HTML appears as
  //
  // ```html
  // <code>$...$</code>
  // ```
  document.addEventListener("DOMContentLoaded", function () {
    // console.log("Replacing inline maths");
    const maths = document.getElementsByTagName("code");
    for (let i = 0; i < maths.length; i++) {
      const el = maths[i];
      console.log("Replacing element: " + el.innerText);
      if (el.innerText.startsWith("$") && el.innerText.endsWith("$")) {
        katex.render(el.innerText.substring(1, el.innerText.length - 1), el, {
          macros: macros,
        });
        el.parentNode.insertBefore(el.firstChild, el);
        el.remove();

        // After being removed, the current index points to the next element.
        i--;
      }
    }
  });
</script>

<style type="text/css">#crate-search{background-image:url("../../down-arrow.svg");}</style></head><body class="rustdoc mod"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="sidebar"><div class="sidebar-menu" role="button">&#9776;</div><a href='../../boltzmann_solver/index.html'><div class='logo-container rust-logo'><img src='../../rust-logo.png' alt='logo'></div></a><h2 class="location">Module solver</h2><div class="sidebar-elems"><div class="block items"><ul><li><a href="#structs">Structs</a></li><li><a href="#enums">Enums</a></li></ul></div><div id="sidebar-vars" data-name="solver" data-ty="mod" data-relpath="./"></div><script defer src="./sidebar-items.js"></script></div></nav><div class="theme-picker"><button id="theme-picker" aria-label="Pick another theme!" aria-haspopup="menu" title="themes"><img width="18" height="18" alt="Pick another theme!" src="../../brush.svg"></button><div id="theme-choices" role="menu"></div></div><nav class="sub"><form class="search-form"><div class="search-container"><div><select id="crate-search"><option value="All crates">All crates</option></select><input class="search-input" name="search" disabled autocomplete="off" spellcheck="false" placeholder="Click or press ‘S’ to search, ‘?’ for more options…" type="search"></div><button type="button" id="help-button" title="help">?</button><a id="settings-menu" href="../../settings.html" title="settings"><img width="18" height="18" alt="Change settings" src="../../wheel.svg"></a></div></form></nav><section id="main" class="content"><h1 class="fqn"><span class="in-band">Module <a href="../index.html">boltzmann_solver</a>::<wbr><a class="mod" href="#">solver</a><button id="copy-path" onclick="copy_path(this)" title="Copy item path to clipboard"><img src="../../clipboard.svg" width="19" height="18" alt="Copy item path"></button></span><span class="out-of-band"><span id="render-detail"><a id="toggle-all-docs" href="javascript:void(0)" title="collapse all docs">[<span class="inner">&#x2212;</span>]</a></span><a class="srclink" href="../../src/boltzmann_solver/solver.rs.html#1-841" title="goto source code">[src]</a></span></h1><details class="rustdoc-toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><p>Solver for the number density evolution given by integrating the Boltzmann
equation.</p>
<p>Solving the Boltzmann equation in generality without making any assumption about
the phase space distribution <code>$f$</code> (other than specifying some initial
condition) is a difficult problem. Furthermore, within the context of
baryogenesis and leptogenesis, we are only interested in the number density (or
more specifically, the difference in the number densities or a particle and its
corresponding antiparticle).</p>
<h1 id="assumptions" class="section-header"><a href="#assumptions">Assumptions</a></h1>
<p>A couple of assumptions can be made to simplify the Boltzmann equation so that
the number densities can be computed directly.</p>
<ul>
<li>
<p><em>Assume kinetic equilibrium.</em> If the rate at which a particle species is
scattering is sufficiently fast, phase space distribution of this species will
rapidly converge converge onto either the Bose–Einstein or Fermi–Dirac
distributions:</p>
<div class="example-wrap"><pre class="language-math"><code>f_{\text{BE}} = \frac{1}{\exp[(E - \mu) \beta] - 1}, \qquad
f_{\text{FD}} = \frac{1}{\exp[(E - \mu) \beta] + 1}.</code></pre></div>
<p>For a particular that remains in kinetic equilibrium, the evolution of its
phase space is entirely described by the evolution of <code>$\mu$</code> in time.</p>
</li>
<li>
<p><em>Assume <code>$\beta \gg E - \mu$</code>.</em> In the limit that the temperature is much less
than <code>$E - \mu$</code> (or equivalently, that the inverse temperature <code>$\beta$</code> is
greater than <code>$E - \mu$</code>), both the Fermi–Dirac and Bose–Einstein approach the
Maxwell–Boltzmann distribution,</p>
<div class="example-wrap"><pre class="language-math"><code>f_{\text{MB}} = \exp[-(E - \mu) \beta].</code></pre></div>
<p>This simplifies the expression for the number density to</p>
<div class="example-wrap"><pre class="language-math"><code>n = \frac{g m^2 K_2(m \beta)}{2 \pi^2 \beta} e^{\mu \beta} = n^{(0)} e^{\mu \beta},</code></pre></div>
<p>where <code>$n^{(0)}$</code> is the equilibrium number density when <code>$\mu = 0$</code>. This
also allows for the equilibrium phase space distribution to be expressed in
terms of the <code>$\mu = 0$</code> distribution:</p>
<div class="example-wrap"><pre class="language-math"><code>f_{\text{MB}} = e^{\mu \beta} f_{\text{MB}}^{(0)} = \frac{n}{n^{(0)}} f_{\text{MB}}^{(0)}.</code></pre></div>
<p>Furthermore, the assumption that <code>$\beta \gg E - \mu$</code> implies that
<code>$f_{\text{BE}}, f_{\text{FD}} \ll 1$</code>. Consequently, the Pauli suppression
and Bose enhancement factors in the collision term can all be neglected
resulting in:</p>
<div class="example-wrap"><pre class="language-math"><code>\begin{aligned}
  g_{a_1} \int \vt C[f_{a_{1}}] \frac{\dd \vt p_{a_1}}{(2\pi)^3}
    &amp;= - \int_{\vt a}^{\vt b}
       \abs{\scM(\vt a \to \vt b)}^2 \left( \prod_{i \in \vt a} f_i \right)
       - \abs{\scM(\vt b \to \vt a)}^2 \left( \prod_{i \in \vt b} f_i \right) \\\\
    &amp;= - \int_{\vt a}^{\vt b}
       \abs{\scM(\vt a \to \vt b)}^2 \left( \prod_{i \in \vt a} \frac{n_i}{n_i^{(0)}} f_i^{(0)} \right)
        - \abs{\scM(\vt b \to \vt a)}^2 \left( \prod_{i \in \vt b} \frac{n_i}{n_i^{(0)}} f_i^{(0)} \right).
\end{aligned}</code></pre></div>
<p>This is then commonly expressed as,</p>
<div class="example-wrap"><pre class="language-math"><code>g_{a_1} \int \vt C[f_{a_{1}}] \frac{\dd \vt p_{a_1}}{(2\pi)^3}
  = - \left( \prod_{i \in \vt a} \frac{n_i}{n_i^{(0)}} \right) \gamma(\vt a \to \vt b)
    + \left( \prod_{i \in \vt b} \frac{n_i}{n_i^{(0)}} \right) \gamma(\vt b \to \vt a),</code></pre></div>
<p>where we have introduced the interaction density</p>
<div class="example-wrap"><pre class="language-math"><code>\gamma(\vt a \to \vt b)
  = \int_{\vt a}^{\vt b}
    \abs{\scM(\vt a \to \vt b)}^2 \left( \prod_{i \in \vt a} f^{(0)}_i \right).</code></pre></div></li>
</ul>
<h1 id="interactions" class="section-header"><a href="#interactions">Interactions</a></h1>
<p>The majority of interactions can be accounted for by looking at simply <code>$1 \leftrightarrow 2$</code> decays/inverse decays and <code>$2 \leftrightarrow 2$</code>
scatterings. In the former case, the phase space integration can be done
entirely analytically and is presented below; whilst in the latter case, the
phase space integration can be simplified to just two integrals.</p>
<h2 id="decays-and-inverse-decays" class="section-header"><a href="#decays-and-inverse-decays">Decays and Inverse Decays</a></h2>
<p>Considering the interaction <code>$a \leftrightarrow b + c$</code>, the reaction is</p>
<div class="example-wrap"><pre class="language-math"><code>\begin{aligned}
  g_a \int \vt C[f_a] \frac{\dd \vt p_a}{(2\pi)^3}
    &amp;= - \frac{n_a}{n^{(0)}_a} \gamma(a \to bc) + \frac{n_b n_c}{n^{(0)}_b n^{(0)}_c} \gamma(bc \to a)
\end{aligned}</code></pre></div>
<p>In every case, the squared matrix element will be completely independent of
all initial and final state momenta (even <code>$\varepsilon \cdot p$</code> terms
vanish after averaging over both initial and final spins).</p>
<h3 id="decay-term" class="section-header"><a href="#decay-term">Decay Term</a></h3>
<p>For the decay, the integration over the final state momenta is trivial as
the only final-state-momentum dependence appears within the Dirac delta
function. Consequently, we need only integrate over the initial state
momentum:</p>
<div class="example-wrap"><pre class="language-math"><code>\begin{aligned}
  \gamma(a \to bc)
    &amp;= - \abs{\scM(a \to bc)}^2 \int_{a}^{b,c} f^{(0)}_a \\\\
    &amp;= - \frac{\abs{\scM(a \to bc)}^2}{16 \pi} \frac{m_a K_1(m_a \beta)}{2 \pi^2 \beta}
\end{aligned}</code></pre></div>
<p>Combined with the number density scaling:</p>
<div class="example-wrap"><pre class="language-math"><code>\frac{n_a}{n^{(0)}_a} \gamma(a \to bc)
  = n_a \frac{\abs{\scM(a \to bc)}^2}{16 \pi m_a} \frac{K_1(m_a \beta)}{K_2(m_a \beta)}</code></pre></div>
<p>where the analytic expression for <code>$n^{(0)}_a$</code> was used to introduce the
second Bessel function.</p>
<p>The ratio of Bessel functions is generally referred to as the <em>time-dilation
factor</em> for the decaying particle. When <code>$m \beta \gg 1$</code>, the ratio of
Bessel functions approaches 1, and when <code>$m \beta \ll 1$</code>, the ratio
approaches 0.</p>
<p>If the final state particles are essentially massless in comparison to the
decaying particle, then the decay rate in the rest frame of the particle of
<code>$\Gamma_\text{rest} = \abs{\scM}^2 / 16 \pi m_a$</code> and the above expression
can be simplified to</p>
<div class="example-wrap"><pre class="language-math"><code>\frac{n_a}{n^{(0)}_a} \gamma(a \to bc)
= n_a \Gamma_\text{rest} \frac{K_1(m_a \beta)}{K_2(m_a \beta)}.</code></pre></div><h3 id="inverse-decay" class="section-header"><a href="#inverse-decay">Inverse Decay</a></h3>
<p>The inverse decay rate is given by</p>
<div class="example-wrap"><pre class="language-math"><code>\gamma(bc \to a)
  = \abs{\scM(bc \to a)}^2 \int_{a}^{b,c} f^{(0)}_b f^{(0)}_c</code></pre></div>
<p>The Dirac delta enforces that <code>$E_a = E_b + E_c$</code> which implies that
<code>$f^{(0)}_a = f^{(0)}_b f^{(0)}_c$</code> thereby making the integral identical to
the decay scenario:</p>
<div class="example-wrap"><pre class="language-math"><code>\gamma(bc \to a)
  = \frac{\abs{\scM(bc \to a)}^2}{16 \pi} \frac{m_a K_1(m_a \beta)}{2 \pi^2 \beta}
  = n^{(0)}_a \frac{\abs{\scM(bc \to a)}^2}{16 \pi m_a} \frac{K_1(m_a \beta)}{K_2(m_a \beta)}</code></pre></div>
<p>The full expression including the number density scaling becomes:</p>
<div class="example-wrap"><pre class="language-math"><code>\frac{n_b n_c}{n^{(0)}_b n^{(0)}_c} \gamma(bc \to a)
  = \frac{n_b n_c}{n^{(0)}_b n^{(0)}_c} n^{(0)}_a \frac{\abs{\scM(bc \to a)}^2}{16 \pi m_a} \frac{K_1(m_a \beta)}{K_2(m_a \beta)}</code></pre></div><h3 id="combined-decay-and-inverse-decay" class="section-header"><a href="#combined-decay-and-inverse-decay">Combined Decay and Inverse Decay</a></h3>
<p>If only the tree-level contributions are considered for the decay and
inverse decays, then both squared amplitudes will be in fact identical and
thus <code>$\gamma(ab \to c) \equiv \gamma(c \to ab)$</code>. As a result, the decay
and inverse decay only differ by a scaling factor to take into account the
initial state particles.</p>
<p>In particular, we can define an alternative reaction rate,</p>
<div class="example-wrap"><pre class="language-math"><code>\tilde \gamma(a \to bc) = \frac{\abs{\scM(a \to bc)}^2}{16 \pi m_a} \frac{K_1(m_a \beta)}{K_2(m_a \beta)},</code></pre></div>
<p>which allows for the overall <code>$1 \leftrightarrow 2$</code> reaction rate to be
expressed as:</p>
<div class="example-wrap"><pre class="language-math"><code>\frac{n_a}{n_a^{(0)}} \gamma(a \to bc) - \frac{n_b n_c}{n_b^{(0)} n_c^{(0)}} \gamma(bc \to a)
= \left[ n_a - \frac{n_b n_c}{n_b^{(0)} n_c^{(0)}} n_a^{(0)} \right] \tilde \gamma(a \to bc)</code></pre></div>
<p>provided the forward and backward rates are equal.</p>
<h2 id="two-body-scattering" class="section-header"><a href="#two-body-scattering">Two Body Scattering</a></h2>
<p>The two-to-two scattering <code>$ab \to cd$</code> reaction density is given by</p>
<div class="example-wrap"><pre class="language-math"><code>\gamma(ab \to cd) = \int_{a,b}^{c,d} \abs{\scM(ab \to cd)}^2 f_a^{(0)} f_b^{(0)}</code></pre></div>
<p>The two initial-state phase space integrals can be reduced to a simple
integral over the centre-of-mass <code>$s$</code>:</p>
<div class="example-wrap"><pre class="language-math"><code>\gamma(ab \to cd) = \frac{1}{8 \pi^3 \beta} \int \hat \sigma_{ab}^{cd}(s) \sqrt{s} K_1(\sqrt{s} \beta) \dd s</code></pre></div>
<p>where <code>$\hat \sigma(s)$</code> is the reduced cross-section:</p>
<div class="example-wrap"><pre class="language-math"><code>\hat \sigma_{ab}^{cd}(s) = \frac{g_a g_b g_c g_d}{64 \pi^2 s} \int \abs{\scM(ab \to cd)}^2 \dd t</code></pre></div>
<p>in which <code>$t$</code> is the usual Mandelstam variable.</p>
<p>As a result, the full <code>$2 \to 2$</code> cross-section can be expressed as</p>
<div class="example-wrap"><pre class="language-math"><code>\gamma(ab \to cd) = \frac{g_a g_b g_c g_d}{512 \pi^5 \beta} \int \abs{\scM(ab \to cd)}^2 \frac{K_1(\sqrt s \beta)}{\sqrt s} \dd s \dd t</code></pre></div><h3 id="real-intermediate-state" class="section-header"><a href="#real-intermediate-state">Real Intermediate State</a></h3>
<p>When considering both <code>$1 \leftrightarrow 2$</code> and <code>$2 \leftrightarrow 2$</code>
scattering processes, there is a double counting issue that arises from
having a real intermediate state (RIS) in <code>$2 \leftrightarrow 2$</code>
interactions.</p>
<p>As a concrete example, one may have the processes <code>$ab \leftrightarrow X$</code>
and <code>$X \leftrightarrow cd$</code> and thus also <code>$ab \leftrightarrow cd$</code>. In
computing the squared amplitude for the <code>$2 \leftrightarrow 2$</code> process, one
needs to subtract the RIS:</p>
<div class="example-wrap"><pre class="language-math"><code>\abs{\scM(ab \leftrightarrow cd)}^2 = \abs{\scM_\text{full}(ab \leftrightarrow cd)}^2
- \abs{\scM_\text{RIS}(ab \leftrightarrow cd)}^2</code></pre></div>
<p>In the case of a single scalar RIS, the RIS-subtracted amplitude is given by</p>
<div class="example-wrap"><pre class="language-math"><code>\begin{aligned}
  \abs{\scM_\text{RIS}(ab \to cd)}
  &amp;= \frac{\pi}{m_X \Gamma_X} \delta(s - m_X^2) \theta(\sqrt{s}) \\
  &amp;\quad \Big[
      \abs{\scM(ab \to X)}^2 \abs{\scM(X \to cd)}^2
    + \abs{\scM(ab \to \overline X)}^2 \abs{\scM(\overline X \to cd)}^2
  \Big].
\end{aligned}</code></pre></div>
<p>Care must be taken for fermions as the spinorial structure prevents a simple
factorization in separate squared amplitude. Furthermore if there are
multiple intermediate states, the mixing between these states must also be
taken into account.</p>
<h1 id="temperature-evolution" class="section-header"><a href="#temperature-evolution">Temperature Evolution</a></h1>
<p>Although it is most intuitive to describe the interaction rates in terms of
time, most quantities depend on the temperature of the Universe at a
particular time. We therefore make the change of variables from <code>$t$</code> to
<code>$\beta$</code> which introduces a factor of <code>$H(\beta) \beta$</code>:</p>
<div class="example-wrap"><pre class="language-math"><code>\pfrac{n}{t} + 3 H n \equiv H \beta \pfrac{n}{\beta} + 3 H n.</code></pre></div>
<p>As a result, the actual change in the number density, it becomes</p>
<div class="example-wrap"><pre class="language-math"><code>\pfrac{n}{\beta} = \frac{1}{H \beta} \left[\vt C[n] - 3 H n\right]</code></pre></div>
<p>and one must only input <code>$\vt C[n]$</code> in the interaction.</p>
<h1 id="normalized-number-density" class="section-header"><a href="#normalized-number-density">Normalized Number Density</a></h1>
<p>The number densities themselves can be often quite large (especially in the
early Universe), and often are compared to other number densities; as a
result, they are often normalized to either the photon number density
<code>$n_\gamma$</code> or the entropy density <code>$s$</code>. This library uses a equilibrium
number density of a single massless bosonic degree of freedom (and thus
differs from using the photon number density by a factor of 2).</p>
<p>When dealing with number densities, the Liouville operator is:</p>
<div class="example-wrap"><pre class="language-math"><code>\pfrac{n}{t} + 3 H n = \vt C[n]</code></pre></div>
<p>where <code>$\vt C[n]$</code> is the change in the number density. If we now define</p>
<div class="example-wrap"><pre class="language-math"><code>Y \defeq \frac{n}{n_{\text{eq}}},</code></pre></div>
<p>then the change in this normalized number density is:</p>
<div class="example-wrap"><pre class="language-math"><code>\pfrac{Y}{t} = \frac{1}{n_{\text{eq}}} \vt C[n]</code></pre></div>
<p>with <code>$n_{\text{eq}}$</code> having the simple analytic form <code>$3 \zeta(3) / 4 \pi^2 \beta^3$</code>. Furthermore, make the change of variable from time <code>$t$</code>
to inverse temperature <code>$\beta$</code>, we get:</p>
<div class="example-wrap"><pre class="language-math"><code>\pfrac{Y}{\beta} = \frac{1}{H \beta n_{\text{eq}}} \vt C[n].</code></pre></div>
<p>As with the non-normalized number density calculations, only <code>$\vt C[n]$</code>
must be inputted in the interaction.</p>
</div></details><h2 id="structs" class="section-header"><a href="#structs">Structs</a></h2>
<div class="item-table"><div class="item-left module-item"><a class="struct" href="struct.Context.html" title="boltzmann_solver::solver::Context struct">Context</a></div><div class="item-right docblock-short"><p>Current context at a particular step in the numerical integration.</p>
</div><div class="item-left module-item"><a class="struct" href="struct.Solver.html" title="boltzmann_solver::solver::Solver struct">Solver</a></div><div class="item-right docblock-short"><p>Boltzmann solver</p>
</div><div class="item-left module-item"><a class="struct" href="struct.SolverBuilder.html" title="boltzmann_solver::solver::SolverBuilder struct">SolverBuilder</a></div><div class="item-right docblock-short"><p>Boltzmann solver builder</p>
</div></div><h2 id="enums" class="section-header"><a href="#enums">Enums</a></h2>
<div class="item-table"><div class="item-left module-item"><a class="enum" href="enum.Error.html" title="boltzmann_solver::solver::Error enum">Error</a></div><div class="item-right docblock-short"><p>Error type returned by the solver in case there is an error during
integration.</p>
</div></div></section><section id="search" class="content hidden"></section><div id="rustdoc-vars" data-root-path="../../" data-current-crate="boltzmann_solver" data-search-index-js="../../search-index.js" data-search-js="../../search.js"></div>
    <script src="../../main.js"></script>
</body></html>